#!/usr/bin/env python3
# Practical 12 â€“ MongoDB Database Connectivity using Python 

from pymongo import MongoClient

# Connect to MongoDB
client = MongoClient("mongodb://localhost:27017/")
print("Connected to MongoDB successfully!\n")

# Create or switch to database
database = client["college"]

# Create or switch to collection
student = database["Details"]

# Clear previous records (optional for testing)
student.delete_many({})
print("Old records cleared from 'Details' collection.\n")

# Insert single record
student1 = {
    'roll_no': "01",
    'name': "Ganesh",
    'age': "20",
    'course': {'coursename': 'Engineering', 'duration': "4 Years"},
    'address': "Indapur"
}
student.insert_one(student1)
print("Inserted single student document:\n", student.find_one(), "\n")

# Insert multiple records
student2 = [
    {'roll_no': "02", 'name': "Rohan", 'age': "19", 'course': {'coursename': "Engineering", 'duration': "4 Years"}, 'address': "Akluj"},
    {'roll_no': "03", 'name': "Sagar", 'age': "21", 'course': {'coursename': "Engineering", 'duration': "4 Years"}, 'address': "Pune"},
    {'roll_no': "04", 'name': "Pratik", 'age': "20", 'course': {'coursename': "Engineering", 'duration': "4 Years"}, 'address': "Solapur"}
]
student.insert_many(student2)
print("Inserted multiple student documents successfully!\n")

# Display all student records
print("All Students in 'Details' Collection:")
for data in student.find({}):
    print(data)
print()

# Display students with specific criteria
print("Students with age == 20:")
for data in student.find({'age': "20"}):
    print(data)
print()

# Update one record
student.update_one({'name': "Pratik"}, {"$set": {"age": "21"}})
print("Updated record (Pratik):")
print(student.find_one({'name': "Pratik"}))
print()

# Update many records (add new field)
student.update_many({}, {"$set": {"pursing_year": 2024}})
print("Added 'pursing_year' field to all records.\n")

# Delete one record
student.delete_one({'name': "Rohan"})
print("Deleted record where name == 'Rohan'\n")

# Display final data
print("Final Student Records:")
for data in student.find({}):
    print(data)

print("\nScript completed successfully!")

