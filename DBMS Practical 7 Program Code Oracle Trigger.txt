DBMS Practical 7 Program Code Oracle10g:

CREATE TABLE lib_tab(book_name VARCHAR2(25),status VARCHAR2(15));

CREATE TABLE library_audit(date_modified DATE, book_name
VARCHAR2(25),old_status VARCHAR(15),new_status VARCHAR2(15),action
VARCHAR2(25));

CREATE OR REPLACE TRIGGER trigger_1
AFTER INSERT OR UPDATE OR DELETE
ON lib_tab
FOR EACH ROW
BEGIN
IF UPDATING THEN
DBMS_OUTPUT.PUT_LINE(:OLD.status);
INSERT INTO library_audit
VALUES (SYSDATE, :OLD.book_name, :OLD.status, :NEW.status, 'UPDATE');
ELSIF INSERTING THEN
DBMS_OUTPUT.PUT_LINE(:NEW.status);
INSERT INTO library_audit
VALUES (SYSDATE, :NEW.book_name, NULL, :NEW.status, 'INSERT');
ELSIF DELETING THEN
DBMS_OUTPUT.PUT_LINE(:OLD.book_name || ' deleting');
INSERT INTO library_audit
VALUES (SYSDATE, :OLD.book_name, :OLD.status, NULL, 'DELETE');
END IF;
END;
/


DELETE FROM lib_tab WHERE book_name = 'SILENT HILL';

UPDATE lib_tab SET status = 'UNAVAILABLE' WHERE book_name = 'UNCHARTED';

UPDATE lib_tab SET status = 'PRE-ORDER' WHERE book_name = 'GOD OF WAR';

UPDATE lib_tab SET status = 'AVAILABLE' WHERE book_name = 'UNCHARTED';

INSERT INTO lib_tab VALUES('SPM','UNAVAILABLE');

Select * from library_audit;
Select * from lib_tab;

INSERT INTO lib_tab VALUES('DARK MATTER','AVAILABLE');
INSERT INTO lib_tab VALUES('SILENT HILL','UNAVAILABLE');
INSERT INTO lib_tab VALUES('GOD OF WAR','AVAILABLE');
INSERT INTO lib_tab VALUES('SPIDER-MAN','UNAVAILABLE');
INSERT INTO lib_tab VALUES('UNCHARTED','AVAILABLE');

DELETE FROM lib_tab WHERE book_name = 'SILENT HILL';
UPDATE lib_tab SET status = 'UNAVAILABLE' WHERE book_name = 'UNCHARTED';

UPDATE lib_tab SET status = 'PRE-ORDER' WHERE book_name = 'GOD OF WAR';

select *from lib_tab;
select *from library_audit;
